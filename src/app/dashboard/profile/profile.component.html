@if (loading) {
<app-fullscreen-loader></app-fullscreen-loader>
} @else {

<main class="mx-auto max-w-7xl px-5 py-10 sm:px-8">

    @if (editMode) {
    <app-edit-profile [selectedUserProfile]="selectedUserProfile" (saved)="getUserProfile()"
        (closeEditMode)="closeEditMode()">
    </app-edit-profile>
    } @else {

    @if (selectedUserProfile) {

    <section class="grid grid-cols-1 gap-6 lg:grid-cols-12">

        <!-- LEFT COLUMN -->
        <div class="space-y-6 lg:col-span-8">

            <!-- PROFILE: header + stats + bio all together -->
            <header class="rounded-2xl bg-zinc-100 p-6">
                <div class="flex flex-col gap-8 md:flex-row md:items-start md:justify-between">

                    <!-- LEFT: Avatar + Identity -->
                    <div class="flex items-start gap-5">
                        <div class="relative h-16 w-16 shrink-0 overflow-hidden rounded-2xl bg-white">
                            <img class="h-full w-full object-cover" [src]="selectedUserProfile.profileImage"
                                alt="Profile photo" />
                        </div>

                        <div class="min-w-0 w-full md:max-w-xl lg:max-w-2xl">
                            <div class="flex flex-wrap items-center gap-3">
                                <h1 class="truncate text-2xl font-semibold text-zinc-950">
                                    {{ selectedUserProfile.firstName }} {{ selectedUserProfile.lastName }}
                                </h1>

                                <!-- Desktop subtle edit -->
                                <button (click)="enableEditMode()" type="button"
                                    class="hidden md:inline-flex items-center gap-2 rounded-xl bg-zinc-200/70 px-3 py-1.5 text-sm font-medium text-zinc-700 hover:bg-zinc-200 transition">
                                    <i class="fa-solid fa-pen text-xs"></i>
                                    Edit
                                </button>
                            </div>

                            <p class="mt-3 text-base leading-relaxed text-zinc-700 md:max-w-lg lg:max-w-xl">
                                {{ selectedUserProfile.bio }}
                            </p>
                        </div>
                    </div>

                    <!-- Mobile edit button -->
                    <div class="md:hidden">
                        <button (click)="enableEditMode()" type="button"
                            class="inline-flex w-full items-center justify-center gap-2 rounded-2xl bg-zinc-950 px-5 py-3 text-sm font-semibold text-white hover:bg-zinc-900 transition">
                            <i class="fa-solid fa-pen"></i>
                            Edit profile
                        </button>
                    </div>
                </div>

                <!-- STATS -->
                <div class="mt-6 grid grid-cols-1 gap-3 sm:grid-cols-3">
                    <!-- Hikes -->
                    <div class="rounded-2xl bg-white p-5">
                        <div class="flex items-center justify-between">
                            <div class="text-sm font-semibold text-zinc-600">Hikes</div>
                            <span class="grid h-10 w-10 place-items-center rounded-xl bg-zinc-100 text-zinc-900">
                                <i class="fa-solid fa-person-hiking"></i>
                            </span>
                        </div>
                        <div class="mt-3 text-3xl font-semibold text-zinc-950">42</div>
                        <div class="mt-1 text-sm text-zinc-600">Total logged</div>
                    </div>

                    <!-- Elevation -->
                    <div class="rounded-2xl bg-white p-5">
                        <div class="flex items-center justify-between">
                            <div class="text-sm font-semibold text-zinc-600">Elevation</div>
                            <span class="grid h-10 w-10 place-items-center rounded-xl bg-zinc-100 text-zinc-900">
                                <i class="fa-solid fa-mountain"></i>
                            </span>
                        </div>
                        <div class="mt-3 text-3xl font-semibold text-zinc-950">18k</div>
                        <div class="mt-1 text-sm text-zinc-600">Meters climbed</div>
                    </div>

                    <!-- Rating -->
                    <div class="rounded-2xl bg-white p-5">
                        <div class="flex items-center justify-between">
                            <div class="text-sm font-semibold text-zinc-600">Avg rating</div>
                            <span class="grid h-10 w-10 place-items-center rounded-xl bg-zinc-100 text-zinc-900">
                                <i class="fa-solid fa-star"></i>
                            </span>
                        </div>
                        <div class="mt-3 text-3xl font-semibold text-zinc-950">4.6</div>
                        <div class="mt-1 text-sm text-zinc-600">From recent routes</div>
                    </div>
                </div>
            </header>

            <!-- Featured route -->
            <section class="rounded-2xl bg-zinc-100 p-6">
                <article class="overflow-hidden rounded-2xl bg-white">
                    <div class="relative h-72">
                        <img class="h-full w-full object-cover"
                            src="https://res.cloudinary.com/dlg9y5dfv/image/upload/v1754473288/munros/3W2A5466-min_ylrgf0.jpg"
                            alt="Featured route" />
                        <div class="absolute inset-0 bg-gradient-to-t from-black/75 via-black/10 to-transparent"></div>

                        <div class="absolute bottom-6 left-6 right-6">
                            <div class="flex items-end justify-between gap-4">
                                <div class="min-w-0">
                                    <div class="truncate text-2xl font-semibold text-white">Featured route</div>
                                    <div class="mt-1 truncate text-base text-white/80">
                                        Ben Nevis • Lochaber • 1,345m
                                    </div>
                                </div>

                                <span
                                    class="shrink-0 rounded-full bg-white/15 px-4 py-2 text-sm font-semibold text-white">
                                    Spotlight
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="p-6">
                        <div class="flex flex-wrap gap-3">
                            <span
                                class="inline-flex items-center gap-2 rounded-full bg-zinc-100 px-4 py-2 text-sm font-semibold text-zinc-700">
                                <i class="fa-solid fa-clock"></i>
                                7–9h
                            </span>
                            <span
                                class="inline-flex items-center gap-2 rounded-full bg-zinc-100 px-4 py-2 text-sm font-semibold text-zinc-700">
                                <i class="fa-solid fa-arrows-up-down"></i>
                                1,320m
                            </span>
                            <span
                                class="inline-flex items-center gap-2 rounded-full bg-emerald-100 px-4 py-2 text-sm font-semibold text-emerald-900">
                                <i class="fa-solid fa-circle-check"></i>
                                Priority
                            </span>
                        </div>

                        <div class="mt-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
                            <div class="flex items-center gap-3 text-sm font-semibold text-zinc-700">
                                <span class="grid h-11 w-11 place-items-center rounded-xl bg-zinc-100 text-zinc-900">
                                    <i class="fa-solid fa-chart-line"></i>
                                </span>
                                Personal best attempt: <span class="text-zinc-950">8h 12m</span>
                            </div>

                            <button
                                class="rounded-3xl bg-zinc-950 px-6 py-3 text-sm font-semibold text-white hover:bg-zinc-900"
                                type="button">
                                <span class="inline-flex items-center gap-2">
                                    <i class="fa-solid fa-bookmark"></i>
                                    Save route
                                </span>
                            </button>
                        </div>
                    </div>
                </article>
            </section>

            <!-- Recent activity -->
            <section class="rounded-2xl bg-zinc-100 p-6">
                <div class="flex items-center justify-between gap-4">
                    <div class="flex items-center gap-3">
                        <span class="grid h-11 w-11 place-items-center rounded-xl bg-white text-zinc-900">
                            <i class="fa-solid fa-wave-square"></i>
                        </span>
                        <h2 class="text-xl font-semibold text-zinc-950">Recent activity</h2>
                    </div>

                    <button class="rounded-3xl bg-white px-5 py-3 text-sm font-semibold text-zinc-800 hover:bg-zinc-50"
                        type="button">
                        <span class="inline-flex items-center gap-2">
                            <i class="fa-solid fa-list"></i>
                            View all
                        </span>
                    </button>
                </div>

                <div class="mt-6 space-y-3">
                    <div class="flex items-center justify-between gap-4 rounded-2xl bg-white p-5">
                        <div class="flex min-w-0 items-center gap-4">
                            <span class="grid h-11 w-11 place-items-center rounded-xl bg-zinc-100 text-zinc-900">
                                <i class="fa-solid fa-circle-check"></i>
                            </span>
                            <div class="min-w-0">
                                <div class="truncate text-base font-semibold text-zinc-950">
                                    Completed: Hampstead Heath loop
                                </div>
                                <div class="mt-1 truncate text-sm text-zinc-600">8.2 km • 2h 05m • 3 days ago</div>
                            </div>
                        </div>
                        <span class="shrink-0 rounded-full bg-zinc-100 px-4 py-2 text-sm font-semibold text-zinc-700">
                            4.0
                        </span>
                    </div>

                    <div class="flex items-center justify-between gap-4 rounded-2xl bg-white p-5">
                        <div class="flex min-w-0 items-center gap-4">
                            <span class="grid h-11 w-11 place-items-center rounded-xl bg-zinc-100 text-zinc-900">
                                <i class="fa-solid fa-calendar-day"></i>
                            </span>
                            <div class="min-w-0">
                                <div class="truncate text-base font-semibold text-zinc-950">
                                    Planned: Seven Sisters day trip
                                </div>
                                <div class="mt-1 truncate text-sm text-zinc-600">14 km • next weekend</div>
                            </div>
                        </div>
                        <span class="shrink-0 rounded-full bg-zinc-100 px-4 py-2 text-sm font-semibold text-zinc-700">
                            Sun
                        </span>
                    </div>

                    <div class="flex items-center justify-between gap-4 rounded-2xl bg-white p-5">
                        <div class="flex min-w-0 items-center gap-4">
                            <span class="grid h-11 w-11 place-items-center rounded-xl bg-zinc-100 text-zinc-900">
                                <i class="fa-solid fa-bookmark"></i>
                            </span>
                            <div class="min-w-0">
                                <div class="truncate text-base font-semibold text-zinc-950">
                                    Saved: Helvellyn via Striding Edge
                                </div>
                                <div class="mt-1 truncate text-sm text-zinc-600">Lake District • When weather clears
                                </div>
                            </div>
                        </div>
                        <span class="shrink-0 rounded-full bg-zinc-100 px-4 py-2 text-sm font-semibold text-zinc-700">
                            Saved
                        </span>
                    </div>
                </div>
            </section>

        </div>

        <!-- RIGHT COLUMN -->
        <aside class="space-y-6 lg:col-span-4">
            <app-goals></app-goals>
        </aside>

    </section>

    }

    }

</main>
}
